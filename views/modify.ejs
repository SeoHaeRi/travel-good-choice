<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="/static/css/modify.css">
  <link rel="stylesheet" href="/static/css/common.css">
  <link rel="stylesheet" href="/static/css/style.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <!--sweetalert -->
  <link href="//cdn.jsdelivr.net/npm/@sweetalert2/theme-minimal/minimal.css" rel="stylesheet">
  <script src="//cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.js"></script>

  <script>
    // function pw_check() {
    //   let pw = $('#pw').val();
    //   let pw2 = $('#pwd').val();

    //   if (pw != pw2) {
    //     $('#checkPw').html("<p>ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤</p>");
    //   };
    //   if (pw == pw2) {
    //     $('#checkPw').html("<p>ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜ğŸ¥°</p>");
    //   };
    // }

    /* ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ */
    function password_modify() {
      const form = document.getElementById('modify_password');
      var flag = checkData();

      if (flag && pwCheck) {
        axios({
          method: 'patch',
          url: "/user/update",
          data: {
            id: form.id.value,
            pw: form.password2.value
          }
        })
          .then((res) => {
            if (res.data) {
              Swal.fire({
                position: 'center',
                icon: 'success',
                title: 'ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.',
                showConfirmButton: false,
                timer: 1500
              });
              setTimeout(function () {
                document.location.href = "/";
              }, 1000);
            } else {
              alert("ì•Œ ìˆ˜ ì—†ëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            }
          });
      }
    }
    // function delete_user() {
    //   const form = document.getElementById('del_form');
    //   var flag = checkData();

    //     axios({
    //       method:'delete',
    //       url:"/user/delete",
    //       data: {
    //         id: form.id2.value,
    //       }
    //     })
    //     .then((res)=>{s
    //       if(res) {
    //         alert("íšŒì›íƒˆí‡´ ì™„ë£Œ")
    //         window.location.href = "/"
    //       }
    //     })
    // }



    /* ë¹„ë°€ë²ˆí˜¸ í™•ì¸ */
    function pwCheck() {
      if (document.getElementById('pw').value != '' && document.getElementById('pwd').value != '') {
        if (document.getElementById('pw').value == document.getElementById('pwd').value) {
          document.getElementById('checkPw').innerHTML = 'ë¹„ë°€ë²ˆí˜¸ ì¼ì¹˜'
          document.getElementById('checkPw').style.color = 'rgb(54, 54, 255)';
          return true;
        }
        else {
          document.getElementById('checkPw').innerHTML = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤';
          document.getElementById('checkPw').style.color = 'rgb(255, 89, 89)';
          return false;
        }
      }
    }

    /* ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬ alert */
    function checkData() {
      var form = document.getElementById("modify_password");

      if (form.password.value == '') {
        Swal.fire({
          icon: 'warning',
          title: 'ë¹„ë°€ë²ˆí˜¸ í™•ì¸í•´ì£¼ì„¸ìš”!',
          text: '45ê¸€ì ì´ë‚´',
        })
        return false;
      }

      if (form.password2.value == '') {
        Swal.fire({
          icon: 'warning',
          title: 'ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì„ í•´ì£¼ì„¸ìš”!',
        })
        return false;
      }
      return true;
    }
    function goHome() {
      document.location.href = "/";
    }
  </script>
  <style>
    .Popup {
      width: 300px;
      height: 50px;
    }
  </style>
</head>

<body>
  <div class="login-div">
    <div onclick="goHome()">
      <a href="/" class="login-logo" title="ì—¬í–‰ì–´ë•Œ">ì—¬í–‰ì–´ë•Œ</a>
    </div>
    <form id="modify_password">
      <h5 class="password_modify">
        <%=name%>ë‹˜ì˜ My Page
      </h5>
      <br>
      <input class="login-input check_input" type="text" id="id" name="nickname" required
        onkeyup="checkNickname( this );" value="ì•„ì´ë”” : <%=id%>" readonly>
      <br>
      <br>
      <input class="login-input checkPw" type="password" name="password" onchange="pwCheck()" id="pw" placeholder="ë¹„ë°€ë²ˆí˜¸"
        required>
      <br>
      <br>
      <input class="login-input checkPw" type="password" name="password2" onchange="pwCheck()" id="pwd"
        placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸" required>
      <div id="checkPw" class="checkPw"></div>
      <br>
      <span id="check"></span>
      <button class="login-btn modifyUser_2" type="button" onclick="password_modify();">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</button>
      <br>
      <br>
  </div>

  <!-- <div class="container text-center">
    <form id="modify_password">
      <div class="form_background"></div>
      <div class="modify_info">
        <div class="login-div">
          <div onclick="goHome()">
            <a href="/" class="login-logo" title="ì—¬í–‰ì–´ë•Œ">ì—¬í–‰ì–´ë•Œ</a>
          </div>
          <h1 class="password_modify">
            <%=name%>ë‹˜ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
          </h1>
          <label for="id" class="check_form">ì•„ì´ë”” :</label>
          <input id="id" type="text" name="id" class="check_input" value="<%=id%>" style="color:black" readonly><br>
          <input id="pw" type="password" name="password" class="checkPw" placeholder="ë¹„ë°€ë²ˆí˜¸" onchange="pwCheck()"
            required style="color:black"><br>
          <input id="pwd" type="password" name="password2" class="checkPw" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸" onchange="pwCheck()"
            required style="color:black"><br><br>
          <div id="checkPw" class="checkPw"></div>
          <br>
          <button type="button" class="modifyUser_2" onclick="password_modify()" style="color:black">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</button>

         
    </form>


</body>

</html>